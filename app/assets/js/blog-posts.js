
		
		function bindPostButtons(el) {
			el.find('.js-edit-post').click(function() {
				$("body").ufModal({
					sourceUrl: site.uri.public + "/modals/blog/post/edit",
					ajaxParams: {
						slug: page.blog.slug,
						id: $(this).data('postId')
					},
					msgTarget: $("#alerts-page")
				});
				$('body').on('renderSuccess.ufModal', function (data) {	
                    ClassicEditor
						.create( document.querySelector( '.js-editor' ) )
						.catch( error => {
							console.error( error );
						} );

					$("#edit-post").ufForm({
						validators: page.validators.postEdit,
						msgTarget: $("#blog-alert")
					}).on("submitSuccess.ufForm", function(event, data, textStatus, jqXHR) {
						window.location.reload();
					});
				});	
			});
			el.find('.js-delete-post').click(function() {
				$("body").ufModal({
					sourceUrl: site.uri.public + "/modals/blog/post/delete",
					ajaxParams: {
						slug: page.blog.slug,
						id: $(this).data('postId')
					},
					msgTarget: $("#alerts-page")
				});
				$('body').on('renderSuccess.ufModal', function (data) {	
					$("#post-delete").ufForm({
						msgTarget: $("#blog-alert")
					}).on("submitSuccess.ufForm", function(event, data, textStatus, jqXHR) {
						window.location.reload();
					});
				});	
			});	
		}
		
		$(document).ready(function() {		
			$("#postsTable").ufTable({
				dataUrl: site.uri.public + "/api/blogs/b/" + page.blog.slug + "/posts"
			});
			
			$("#postsTable").on("pagerComplete.ufTable", function () {
			    bindPostButtons($(this));
			});
			
			$("#btn_create_post").click(function() {
				$('body').ufModal({
					// URL that serves the modal HTML
					sourceUrl: site.uri.public + '/modals/blog/post/create',
					ajaxParams : {
						"blog_slug" : page.blog.slug
					},
					// Target element to display any errors generated by the modal request
					msgTarget: $('#alerts-page')
				});

				
				
				
				
                $('body').on('renderSuccess.ufModal', function (data) {
                    ClassicEditor
						.create( document.querySelector( '.js-editor' ) )
						.catch( error => {
							console.error( error );
						} );
											
					$("#create-post").ufForm({
						validators: page.validators.postCreate,
						msgTarget: $("#blog-alert")
					}).on("submitSuccess.ufForm", function(event, data, textStatus, jqXHR) {
						window.location.reload();
					});
				});
			});
        });
        function clearEditor() 
        {
            for (var i = tinymce.editors.length - 1 ; i > -1 ; i--) {
                var ed_id = tinymce.editors[i].id;
                tinyMCE.execCommand("mceRemoveEditor", true, ed_id);
            }
        }