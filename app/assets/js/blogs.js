function bindBlogButtons(el) {
    el.find('.js-blog-edit').click(function() {
        $("body").ufModal({
            sourceUrl: site.uri.public + "/modals/blog/edit",
            ajaxParams: {
                id: $(this).data('id')
            },
            msgTarget: $("#alerts-page")
        });
        $('body').on('renderSuccess.ufModal', function (data) {
            
            $("#edit-blog").ufForm({
                validators: page.validators.blog,
                msgTarget: $("#blog-alert")
            }).on("submitSuccess.ufForm", function(event, data, textStatus, jqXHR) {
                window.location.reload();
            });
        });
    });
    
    el.find('.js-blog-delete').click(function() {
            
            $("body").ufModal({
                sourceUrl: site.uri.public + "/modals/blog/confirm-delete",
                ajaxParams: {
                    id: $(this).data('id')
                },
                msgTarget: $("#alerts-page")
            });
            $('body').on('renderSuccess.ufModal', function (data) {
            $("#blog-delete").ufForm({
                msgTarget: $("#form-delete-blog-error")
            }).on("submitSuccess.ufForm", function(event, data, textStatus, jqXHR) {
                window.location.reload();
            });
        });
    });   
}

function bindBlogCreateButton() {
    $("#btn_create_blog").click(function() {
        $('body').ufModal({
            // URL that serves the modal HTML
            sourceUrl: site.uri.public + '/modals/blog/create',
            // Target element to display any errors generated by the modal request
            msgTarget: $('#alerts-page')
        });
        
        $('body').on('renderSuccess.ufModal', function (data) {
            $("#create-blog").ufForm({
                validators: page.validators.blog,
                msgTarget: $("#blog-alert")
            }).on("submitSuccess.ufForm", function(event, data, textStatus, jqXHR) {
                window.location.reload();
            });
        });
    });
}

$(document).ready(function() {
    
    $("#blogTable").ufTable({
        dataUrl: site.uri.public + "/api/blogs"
    });
    
    $("#blogTable").on("pagerComplete.ufTable", function () {
        bindBlogButtons($(this));
    });
    
    bindBlogCreateButton();
});